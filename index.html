<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Hay Farm - Map</title>

<style>
body{
  margin:0;
  font-family:Tahoma;
  overflow:hidden;
  background:#9ae6b4;
}
header{
  background:#f6ad55;
  padding:8px;
  display:flex;
  justify-content:space-around;
  font-weight:bold;
}
#world{
  width:100vw;
  height:calc(100vh - 50px);
  overflow:hidden;
  touch-action:none;
}
#map{
  width:2000px;
  height:2000px;
  background:linear-gradient(#86efac,#4ade80);
  position:relative;
  transform-origin:0 0;
}
.building{
  width:80px;
  height:80px;
  background:#fde68a;
  border:3px solid #6b7280;
  border-radius:16px;
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
  cursor:grab;
}
</style>
</head>

<body>

<header>
üí∞ <span id="coins">0</span>
‚≠ê XP <span id="xp">0</span>
üèÖ Lv <span id="level">1</span>
</header>

<div id="world">
  <div id="map"></div>
</div>

<script>
// ================= ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ =================
let coins=0,xp=0,level=1;
let zoom=1, panX=0, panY=0;
let draggingMap=false;
let startX,startY;

// ÿßŸÑŸÖÿ®ÿßŸÜŸä
let buildings=[
  {id:"farm",icon:"üåæ",x:200,y:200},
  {id:"bakery",icon:"üè≠",x:350,y:200,last:Date.now()},
  {id:"chicken",icon:"üêî",x:500,y:200,last:Date.now()},
  {id:"cow",icon:"üêÑ",x:650,y:200,last:Date.now()},
  {id:"sheep",icon:"üêë",x:800,y:200,last:Date.now()},
  {id:"cakeFactory",icon:"üç∞",x:950,y:200,last:Date.now()},
  {id:"jamFactory",icon:"ü´ô",x:1100,y:200,last:Date.now()}
];


// ================= ÿ≠ŸÅÿ∏ =================
function save(){
  localStorage.setItem("hayfarm_map",JSON.stringify({coins,xp,level,buildings}));
}
function load(){
  const s=JSON.parse(localStorage.getItem("hayfarm_map"));
  if(s){
    coins=s.coins;xp=s.xp;level=s.level;
    buildings=s.buildings;
  }
}
load();

// ================= Ÿàÿßÿ¨Ÿáÿ© =================
const coinsEl=document.getElementById("coins");
const xpEl=document.getElementById("xp");
const levelEl=document.getElementById("level");
function ui(){
  coinsEl.textContent=coins;
  xpEl.textContent=xp;
  levelEl.textContent=level;
  save();
}
ui();

// ================= ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖÿ®ÿßŸÜŸä =================
const map=document.getElementById("map");

function renderBuildings(){
  map.innerHTML="";
  buildings.forEach(b=>{
    const el=document.createElement("div");
    el.className="building";
    el.textContent=b.icon;
    el.style.left=b.x+"px";
    el.style.top=b.y+"px";

    // ÿ≥ÿ≠ÿ® ÿßŸÑŸÖÿ®ŸÜŸâ
    let drag=false,ox,oy;
    el.onmousedown=e=>{
      drag=true;
      ox=e.clientX-b.x;
      oy=e.clientY-b.y;
      e.stopPropagation();
    };
    window.onmouseup=()=>drag=false;
    window.onmousemove=e=>{
      if(!drag)return;
      b.x=e.clientX-ox;
      b.y=e.clientY-oy;
      el.style.left=b.x+"px";
      el.style.top=b.y+"px";
      save();
    };

    map.appendChild(el);
  });
}
renderBuildings();

// ================= ÿ≥ÿ≠ÿ® ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ© =================
const world=document.getElementById("world");

world.onmousedown=e=>{
  draggingMap=true;
  startX=e.clientX-panX;
  startY=e.clientY-panY;
};
window.onmouseup=()=>draggingMap=false;
window.onmousemove=e=>{
  if(!draggingMap)return;
  panX=e.clientX-startX;
  panY=e.clientY-startY;
  map.style.transform=`translate(${panX}px,${panY}px) scale(${zoom})`;
};

// ================= Zoom =================
world.onwheel=e=>{
  zoom+=e.deltaY*-0.001;
  zoom=Math.min(Math.max(0.4,zoom),2);
  map.style.transform=`translate(${panX}px,${panY}px) scale(${zoom})`;
};
</script>

</body>
</html>

