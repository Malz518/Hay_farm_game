
```html
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Hay Farm - Ù„Ø¹Ø¨Ø© Ù…Ø²Ø±Ø¹Ø©</title>

  <!-- Firebase (Compat Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØªØ¹Ù„Ù…) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body{margin:0;font-family:Tahoma;background:linear-gradient(#9ae6b4,#68d391);user-select:none}
    header{background:#f6ad55;padding:10px;display:flex;gap:6px;justify-content:space-around;box-shadow:0 4px 6px rgba(0,0,0,.2)}
    .stat{background:#fff3cd;padding:6px 10px;border-radius:12px;font-weight:bold}
    #farm{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:15px}
    .plot{background:#fefcbf;border:4px solid #d69e2e;border-radius:18px;height:100px;display:flex;justify-content:center;align-items:center;flex-direction:column;cursor:pointer;text-align:center}
    .ready{background:#9ae6b4}
    .working{background:#faf089}
    button{border:none;background:#f6ad55;padding:6px 12px;border-radius:12px;font-weight:bold;cursor:pointer;margin:3px}
  </style>
</head>
<body>

<header>
  <div class="stat">ğŸ’° <span id="coins">0</span></div>
  <div class="stat">â­ Lv <span id="level">1</span></div>
  <div class="stat">âœ¨ XP <span id="exp">0</span></div>
  <div class="stat">ğŸŒ¾ <span id="wheat">0</span></div>
  <div class="stat">ğŸ <span id="bread">0</span></div>
</header>

<div id="farm"></div>

<script>
/* ================= Firebase Config ================= */
const firebaseConfig = {
  apiKey: "PUT_YOUR_KEY",
  authDomain: "PUT_YOUR_DOMAIN",
  projectId: "PUT_YOUR_PROJECT_ID"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

let uid;
let gameData;

/* ================= Auth ================= */
auth.signInAnonymously().then(res=>{
  uid = res.user.uid;
  loadGame();
});

/* ================= Load ================= */
async function loadGame(){
  const ref = db.collection('users').doc(uid);
  const doc = await ref.get();

  if(!doc.exists){
    gameData = {
      coins:100,
      level:1,
      exp:0,
      nextLevelExp:50,
      plots:Array(8).fill(null),
      storage:{
        wheat:{amount:0,max:20},
        bread:{amount:0,max:10}
      },
      bakery:{level:1,producing:false,finish:0},
      dailyTask:null
    };
    newDailyTask();
    await ref.set(gameData);
  } else {
    gameData = doc.data();
    if(!gameData.bakery) gameData.bakery={level:1,producing:false,finish:0};
    if(!gameData.storage) gameData.storage={wheat:{amount:0,max:20},bread:{amount:0,max:10}};
    if(!gameData.dailyTask) newDailyTask();
  }
  render();
}

/* ================= Render ================= */
function render(){
  coins.textContent = gameData.coins;
  level.textContent = gameData.level;
  exp.textContent = gameData.exp;
  wheat.textContent = gameData.storage.wheat.amount;
  bread.textContent = gameData.storage.bread.amount;

  farm.innerHTML='';

  // Ø§Ù„Ø­Ù‚ÙˆÙ„
  gameData.plots.forEach((plot,i)=>{
    const div=document.createElement('div');
    div.className='plot';

    if(!plot){
      div.innerHTML='â• Ø²Ø±Ø¹ Ù‚Ù…Ø­';
      div.onclick=()=>plant(i);
    } else if(Date.now()>=plot.finish){
      div.classList.add('ready');
      div.innerHTML='ğŸŒ¾ Ø¬Ø§Ù‡Ø²<br><button>Ø­ØµØ§Ø¯</button>';
      div.onclick=()=>harvest(i);
    } else {
      div.classList.add('working');
      div.innerHTML='â³ ÙŠÙ†Ù…Ùˆ';
    }
    farm.appendChild(div);
  });

  // Ø§Ù„Ù…Ø®Ø¨Ø²
  const bakery=document.createElement('div');
  bakery.className='plot';

  if(!gameData.bakery.producing){
    bakery.innerHTML=`ğŸ­ Ù…Ø®Ø¨Ø² Lv ${gameData.bakery.level}
    <button onclick="startBakery()">ØµÙ†Ø¹ Ø®Ø¨Ø²</button>
    <button onclick="upgradeBakery()">â¬†ï¸ ØªØ±Ù‚ÙŠØ©</button>`;
  } else if(Date.now()>=gameData.bakery.finish){
    bakery.classList.add('ready');
    bakery.innerHTML='ğŸ Ø§Ù„Ø®Ø¨Ø² Ø¬Ø§Ù‡Ø²<br><button onclick="collectBread()">Ø§Ø³ØªÙ„Ø§Ù…</button>';
  } else {
    bakery.classList.add('working');
    bakery.innerHTML='â³ ÙŠØ®Ø¨Ø²';
  }
  farm.appendChild(bakery);
}

/* ================= Gameplay ================= */
function plant(i){
  if(gameData.storage.wheat.amount>=gameData.storage.wheat.max){
    alert('ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù† Ù…Ù…ØªÙ„Ø¦');return;
  }
  gameData.plots[i]={finish:Date.now()+10000};
  save();
}

function harvest(i){
  if(Date.now()<gameData.plots[i].finish) return;
  gameData.plots[i]=null;
  gameData.storage.wheat.amount++;
  gameData.coins+=5;
  addExp(10);
  taskProgress('harvest_wheat');
  save();
}

function startBakery(){
  if(gameData.storage.wheat.amount<2){alert('ØªØ­ØªØ§Ø¬ 2 Ù‚Ù…Ø­');return;}
  if(gameData.bakery.producing) return;

  const time=15000/gameData.bakery.level;
  gameData.storage.wheat.amount-=2;
  gameData.bakery.producing=true;
  gameData.bakery.finish=Date.now()+time;
  save();
}

function collectBread(){
  if(Date.now()<gameData.bakery.finish) return;
  if(gameData.storage.bread.amount>=gameData.storage.bread.max){alert('ğŸ“¦ Ù…Ø®Ø²Ù† Ø§Ù„Ø®Ø¨Ø² Ù…Ù…ØªÙ„Ø¦');return;}

  gameData.bakery.producing=false;
  gameData.storage.bread.amount++;
  gameData.coins+=15;
  addExp(15);
  save();
}

function upgradeBakery(){
  const cost=gameData.bakery.level*100;
  if(gameData.coins<cost){alert('ğŸ’° Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Øª');return;}
  gameData.coins-=cost;
  gameData.bakery.level++;
  alert('ğŸ‰ ØªÙ…Øª Ø§Ù„ØªØ±Ù‚ÙŠØ©');
  save();
}

/* ================= Level ================= */
function addExp(x){
  gameData.exp+=x;
  if(gameData.exp>=gameData.nextLevelExp){
    gameData.exp-=gameData.nextLevelExp;
    gameData.level++;
    gameData.nextLevelExp=Math.floor(gameData.nextLevelExp*1.5);
    alert('ğŸ‰ ÙˆØµÙ„Øª Ù„Ù„Ù…Ø³ØªÙˆÙ‰ '+gameData.level);
  }
}

/* ================= Daily Task ================= */
function newDailyTask(){
  gameData.dailyTask={type:'harvest_wheat',target:5,progress:0,rewardCoins:50,rewardExp:20,date:new Date().toDateString()};
}

function taskProgress(type){
  const t=gameData.dailyTask;
  if(!t||t.type!==type) return;
  t.progress++;
  if(t.progress>=t.target){
    gameData.coins+=t.rewardCoins;
    addExp(t.rewardExp);
    alert('ğŸ¯ Ø£Ù†Ù‡ÙŠØª Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©');
    newDailyTask();
  }
}

/* ================= Save ================= */
function save(){
  db.collection('users').doc(uid).set(gameData);
  render();
}
</script>
</body>
</html>
